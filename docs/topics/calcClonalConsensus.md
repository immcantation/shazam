





**calcClonalConsensus** - *Calculate clonal consensus for a single clone*

Description
--------------------

Calculate clonal consensus for a single clone


Usage
--------------------
```
calcClonalConsensus(inputSeq, germlineSeq, regionDefinition = NULL,
method = c("thresholdedFreq", "mostCommon", "catchAll"),
minimumFrequency = 0.6)
```

Arguments
-------------------

inputSeq
:   character vector of observed sequences.

germlineSeq
:   character vector of germline sequences.

regionDefinition
:   [RegionDefinition](RegionDefinition-class.md) object defining the regions
and boundaries of the Ig sequences.

method
:   method to calculate consensus sequence. One of `thresholdedFreq`, 
`mostCommon`, or `catchAll`. See `Details` for
[calcClonalConsensusHelper](calcClonalConsensusHelper.md).

minimumFrequency
:   minimum frequency. Required if `method` is `thresholdedFreq`.
Default is 0.6. See `Details` for [calcClonalConsensusHelper](calcClonalConsensusHelper.md).




Value
-------------------

A named vector of length two with "input" and "germline" consensus sequences. The
input and germline consensus sequences have the same length.


Details
-------------------

Note that this function does not perform multiple sequence alignment. As a 
prerequisite, it is assumed that sequences in `inputSeq` and `germlineSeq`
have each been aligned somehow. In the case of immunoglobulin repertoire analysis, 
this usually means that the sequences are IMGT-gapped.

The germline consensus is generated by [calcClonalConsensusHelper](calcClonalConsensusHelper.md) with the 
`mostCommon` method. 

An input/observed consensus is generated, also by 
[calcClonalConsensusHelper](calcClonalConsensusHelper.md), with the method of choice indicated by 
`method`. 

The lengths of the consensus sequences are determined by the longest possible consensus
sequence (baesd on `inputSeq` and `germlineSeq`) and 
`regionDefinition@seqLength` (if supplied), whichever that is shorter. 

See `Details` for [calcClonalConsensusHelper](calcClonalConsensusHelper.md) for details on `method`
and `minimumFrequency`.



Examples
-------------------

```R
# Subset example data
data(ExampleDb, package="alakazam")
db <- subset(ExampleDb, ISOTYPE %in% c("IgA", "IgG") & SAMPLE == "+7d")

# Data corresponding to a single clone
clone <- db[db$CLONE=="3192", ]
# Number of sequences in this clone
nrow(clone)

```


```
[1] 19

```


```R

# Get consensus input and germline sequences
cons <- calcClonalConsensus(inputSeq=clone$SEQUENCE_IMGT, 
germlineSeq=clone$GERMLINE_IMGT_D_MASK,
method="catchAll")
```



See also
-------------------

[calcClonalConsensusHelper](calcClonalConsensusHelper.md) and [collapseClones](collapseClones.md).



