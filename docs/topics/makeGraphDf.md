**makeGraphDf** - *Build a data.frame from a ChangeoClone and an igraph object containing a clonal lineage*

Description
--------------------

`makeGraphDf` creates a data.frame from a [ChangeoClone](http://www.rdocumentation.org/packages/alakazam/topics/ChangeoClone-class) and igraph object 
containing a B cell lineage tree and associated sequence data, returning a data.frame the 
original fields and additions such as each sequence's parent in the lineage tree, 
additional rows for inferred sequences, and the lineage germline.


Usage
--------------------
```
makeGraphDf(
curCloneGraph,
curCloneObj,
objSeqId = "sequence_id",
objSeq = "sequence"
)
```

Arguments
-------------------

curCloneGraph
:   `igraph` object for the lineage tree generated by 
[buildPhylipLineage](http://www.rdocumentation.org/packages/alakazam/topics/buildPhylipLineage). Note, the field containing the 
nucleotide sequence in the object must be name `sequence`.

curCloneObj
:   [ChangeoClone](http://www.rdocumentation.org/packages/alakazam/topics/ChangeoClone-class) object used to generate the lineage.

objSeqId
:   name of the sequence identifier field in `curCloneObj`.

objSeq
:   nameof the nucleotide sequence field in `curCloneObj`.




Value
-------------------

A `data.frame` with sequence and lineage information, including the
the parent nucleotide sequence in the lineage tree(`parent_sequence`), 
an internal parent identifier (`parent`), and additional rows for germline 
sequence and inferred intermediate sequences.

Additionally, values in the `sequence_id` field are renamed to numeric values,
prefixed with the clonal grouping identifier and denote as either `"Inferred"` 
or `"Germline"` if they are not an observed sequence. For example, for a lineage 
with `clone_id=34` the new identifiers would be of the form: 
`"34_Germline"`, `"34_Inferred1"`, `"34_1"`, `"34_2"`, etc.

The original sequence identifier is preserved in the `orig_sequence_id` field 
and the original parent sequence identifier is retained in `orig_parent`.



Examples
-------------------

```R
# Load and subset example data
data(ExampleDb, package="alakazam")
data(ExampleTrees, package="alakazam")
graph <- ExampleTrees[[17]]
db <- subset(ExampleDb, clone_id == graph$clone)
clone <- alakazam::makeChangeoClone(db)

# Extend data with lineage information
df <- makeGraphDf(graph, clone)
```



See also
-------------------

See [observedMutations](observedMutations.md) to calculate mutation frequencies using
`parent_sequence` as the reference germline. See [ChangeoClone](http://www.rdocumentation.org/packages/alakazam/topics/ChangeoClone-class),
[buildPhylipLineage](http://www.rdocumentation.org/packages/alakazam/topics/buildPhylipLineage), and [igraph](http://www.rdocumentation.org/packages/igraph/topics/aaa-igraph-package) for details on the 
input objects.






