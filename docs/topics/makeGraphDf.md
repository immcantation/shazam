**makeGraphDf** - *Create a `ChangeClone` data frame, with parent sequence information extracted from a lineage graph*

Description
--------------------

`makeGraphDf` creates a `ChangeoClone` data frame with additional information about
each sequence's parent in the lineage tree, additional rows for inferred sequences, and the lineage 
germline.


Usage
--------------------
```
makeGraphDf(
curCloneGraph,
curCloneObj,
objSeqId = "sequence_id",
objSeq = "sequence"
)
```

Arguments
-------------------

curCloneGraph
:   the lineage `igraph` object for a specific clone,
generated by `buildPhylipLineage`. Note: the function expects the
sequence field  name in `curCloneGraph` be `sequence`.

curCloneObj
:   the `ChangeoClone` object used to generate the lineage.

objSeqId
:   sequence id field name in `curCloneObj`.

objSeq
:   sequence field name in `curCloneObj`.




Value
-------------------

A `ChangeoClone` data frame with additional columns (`parent_sequence` 
and `parent`) and additional rows (for germline and inferred sequences)


Details
-------------------

`makeGraphDf` adds to the `ChangeoClone` data frame: 

+  Columns:

+ `parent_sequence`:  The parent sequence in the lineage tree.
+ `parent`:           The `parent_sequence` id.    

+  Rows:

+ A row for each `Inferred` sequence.
+ A row for the `Germline` in the lineage graph.




Note
-------------------

`makeGraphDf` also renames sequence_id content according to the following 
(assume clone number is 34):  

34_Germline, 34_Inferred1, 34_1, 34_2, 34_3, 34_Inferred2, 34_4, etc.

The original sequence id is kept under a new column named `orig_sequence_id`, 
and the original parent sequence id is kept under a new column named `orig_parent`.



Examples
-------------------

```R
### Not run:
library("igraph")

```

*
Attaching package: ‘igraph’
**The following objects are masked from ‘package:stats’:

    decompose, spectrum
**The following object is masked from ‘package:base’:

    union
*
```R
# library("dplyr")
# # Load and subset example data:
# data(ExampleDb, package="alakazam")
# clone_3170_db <- subset(ExampleDb, clone_id == 3170)
# clone_3170_obj <- makeChangeoClone(clone_3170_db, 
# seq="sequence_alignment",
# germ="germline_alignment")
# dnapars_exec <- "~/apps/phylip-3.69/dnapars"
# clone_3170_graph <- buildPhylipLineage(clone_3170_obj, 
# dnapars_exec, rm_temp = TRUE)  
# clone_3170_GraphDf <- makeGraphDf(clone_3170_graph, clone_3170_obj)
```



See also
-------------------

See [observedMutations](observedMutations.md) to calculate mutation frequencies using
`parent_sequence` as reference germline.






